Ignoring: branches, cache, langauge, sudo
START gemfile: gemfiles/4.1.16.gemfile rvm: 2.2.6
bundle install --deployment --path ruby-json-benchmark/vendor/bundle --quiet
bundle exec ruby compatibility_test.rb && bundle exec ruby benchmark.rb

Comparing Rails to_json with other JSON implementations
+---------------------------------+--------------+---------+------------------+------------+-----------------+
| class                           | JSON to_json | Oj.dump | Oj::Rails.encode | Oj to_json | msgpack "rails" |
+---------------------------------+--------------+---------+------------------+------------+-----------------+
| Regexp                          | 👌           | 👌      | 👌               | 👌         | 👌              |
| FalseClass                      | 👌           | 👌      | 👌               | 👌         | 👌              |
| NilClass                        | 👌           | 👌      | 👌               | 👌         | 👌              |
| Object                          | ❌           | 👌      | 👌               | 👌         | 👌              |
| TrueClass                       | 👌           | 👌      | 👌               | 👌         | 👌              |
| String                          | 👌           | 👌      | 👌               | 👌         | 👌              |
| StringChinese                   | 👌           | 👌      | 👌               | 👌         | 👌              |
| StringSpecial                   | ❌           | 👌      | 👌               | 👌         | 👌              |
| StringSpecial2                  | 👌           | 👌      | 👌               | 👌         | 👌              |
| StringSpecial3                  | 👌           | 👌      | 👌               | 👌         | 👌              |
| Numeric                         | 👌           | 👌      | 👌               | 👌         | 👌              |
| Symbol                          | 👌           | 👌      | 👌               | 👌         | 👌              |
| Time                            | ❌           | 👌      | 👌               | 👌         | 👌              |
| Array                           | 👌           | 👌      | 👌               | 👌         | 👌              |
| Hash                            | 👌           | 👌      | 👌               | 👌         | 👌              |
| HashNotEmpty                    | 👌           | 👌      | 👌               | 👌         | 👌              |
| Date                            | 👌           | 👌      | 👌               | 👌         | 👌              |
| DateTime                        | ❌           | 👌      | 👌               | 👌         | 👌              |
| Enumerable                      | ❌           | 👌      | 👌               | 👌         | 👌              |
| BigDecimal                      | ❌           | 👌      | 👌               | 👌         | 👌              |
| BigDecimalInfinity              | ❌           | 👌      | 👌               | 👌         | 👌              |
| Struct                          | ❌           | 👌      | 👌               | 👌         | 👌              |
| Float                           | 👌           | 👌      | 👌               | 👌         | 👌              |
| FloatInfinity                   | 💀           | 👌      | 👌               | 👌         | ❌              |
| Range                           | 👌           | 👌      | 👌               | 👌         | 👌              |
| Complex                         | 👌           | 👌      | 👌               | 👌         | 👌              |
| Exception                       | ❌           | 👌      | 👌               | 👌         | 👌              |
| OpenStruct                      | ❌           | 👌      | 👌               | 👌         | 👌              |
| Rational                        | 👌           | 👌      | 👌               | 👌         | 👌              |
| Process::Status                 | ❌           | 👌      | 👌               | 👌         | 👌              |
| ActiveSupport::TimeWithZone     | ❌           | 👌      | 👌               | 👌         | 👌              |
| ActiveModel::Errors             | ❌           | 👌      | 👌               | 👌         | 👌              |
| ActiveSupport::Duration         | ❌           | 👌      | 👌               | 👌         | 👌              |
| ActiveSupport::Multibyte::Chars | ❌           | 👌      | 👌               | 👌         | 👌              |
| ActiveRecord::Relation          | ❌           | 👌      | 👌               | 👌         | 👌              |
| ActiveRecord                    | ❌           | 👌      | 👌               | 👌         | 👌              |
+---------------------------------+--------------+---------+------------------+------------+-----------------+

Calculating -------------------------------------
       Rails to_json   537.143M memsize (   248.000  retained)
                        10.930M objects (     4.000  retained)
                        50.000  strings (     0.000  retained)
             msgpack   259.980M memsize (   232.000  retained)
                         4.580M objects (     1.000  retained)
                        50.000  strings (     0.000  retained)
             Oj.dump    64.950M memsize (    40.000  retained)
                         1.120M objects (     1.000  retained)
                        39.000  strings (     0.000  retained)
    Oj::Rails.encode    64.950M memsize (     0.000  retained)
                         1.120M objects (     0.000  retained)
                        39.000  strings (     0.000  retained)

Comparison:
    Oj::Rails.encode:   64950000 allocated
             Oj.dump:   64950040 allocated - 1.00x more
             msgpack:  259980232 allocated - 4.00x more
       Rails to_json:  537142520 allocated - 8.27x more
---------------------------------------------

Warming up --------------------------------------
       Rails to_json   216.000  i/100ms
             msgpack   602.000  i/100ms
             Oj.dump     1.847k i/100ms
    Oj::Rails.encode     1.633k i/100ms
Calculating -------------------------------------
       Rails to_json      2.500k (±10.1%) i/s -     12.528k in   5.065021s
             msgpack      5.077k (±21.4%) i/s -     24.080k in   5.008469s
             Oj.dump     19.315k (± 7.2%) i/s -     96.044k in   4.999924s
    Oj::Rails.encode     17.740k (±13.0%) i/s -     88.182k in   5.063018s

Comparison:
             Oj.dump:    19314.5 i/s
    Oj::Rails.encode:    17740.0 i/s - same-ish: difference falls within error
             msgpack:     5076.6 i/s - 3.80x  slower
       Rails to_json:     2499.8 i/s - 7.73x  slower


SUCCESS gemfile: gemfiles/4.1.16.gemfile rvm: 2.2.6
START gemfile: gemfiles/4.1.16.gemfile rvm: 2.3.3
bundle install --deployment --path ruby-json-benchmark/vendor/bundle --quiet
bundle exec ruby compatibility_test.rb && bundle exec ruby benchmark.rb

Comparing Rails to_json with other JSON implementations
+---------------------------------+--------------+---------+------------------+------------+-----------------+
| class                           | JSON to_json | Oj.dump | Oj::Rails.encode | Oj to_json | msgpack "rails" |
+---------------------------------+--------------+---------+------------------+------------+-----------------+
| Regexp                          | 👌           | 👌      | 👌               | 👌         | 👌              |
| FalseClass                      | 👌           | 👌      | 👌               | 👌         | 👌              |
| NilClass                        | 👌           | 👌      | 👌               | 👌         | 👌              |
| Object                          | ❌           | 👌      | 👌               | 👌         | 👌              |
| TrueClass                       | 👌           | 👌      | 👌               | 👌         | 👌              |
| String                          | 👌           | 👌      | 👌               | 👌         | 👌              |
| StringChinese                   | 👌           | 👌      | 👌               | 👌         | 👌              |
| StringSpecial                   | ❌           | 👌      | 👌               | 👌         | 👌              |
| StringSpecial2                  | 👌           | 👌      | 👌               | 👌         | 👌              |
| StringSpecial3                  | 👌           | 👌      | 👌               | 👌         | 👌              |
| Numeric                         | 👌           | 👌      | 👌               | 👌         | 👌              |
| Symbol                          | 👌           | 👌      | 👌               | 👌         | 👌              |
| Time                            | ❌           | 👌      | 👌               | 👌         | 👌              |
| Array                           | 👌           | 👌      | 👌               | 👌         | 👌              |
| Hash                            | 👌           | 👌      | 👌               | 👌         | 👌              |
| HashNotEmpty                    | 👌           | 👌      | 👌               | 👌         | 👌              |
| Date                            | 👌           | 👌      | 👌               | 👌         | 👌              |
| DateTime                        | ❌           | 👌      | 👌               | 👌         | 👌              |
| Enumerable                      | ❌           | 👌      | 👌               | 👌         | 👌              |
| BigDecimal                      | ❌           | 👌      | 👌               | 👌         | 👌              |
| BigDecimalInfinity              | ❌           | 👌      | 👌               | 👌         | 👌              |
| Struct                          | ❌           | 👌      | 👌               | 👌         | 👌              |
| Float                           | 👌           | 👌      | 👌               | 👌         | 👌              |
| FloatInfinity                   | 💀           | 👌      | 👌               | 👌         | ❌              |
| Range                           | 👌           | 👌      | 👌               | 👌         | 👌              |
| Complex                         | 👌           | 👌      | 👌               | 👌         | 👌              |
| Exception                       | ❌           | 👌      | 👌               | 👌         | 👌              |
| OpenStruct                      | ❌           | 👌      | 👌               | 👌         | 👌              |
| Rational                        | 👌           | 👌      | 👌               | 👌         | 👌              |
| Process::Status                 | ❌           | 👌      | 👌               | 👌         | 👌              |
| ActiveSupport::TimeWithZone     | ❌           | 👌      | 👌               | 👌         | 👌              |
| ActiveModel::Errors             | ❌           | 👌      | 👌               | 👌         | 👌              |
| ActiveSupport::Duration         | ❌           | 👌      | 👌               | 👌         | 👌              |
| ActiveSupport::Multibyte::Chars | ❌           | 👌      | 👌               | 👌         | 👌              |
| ActiveRecord::Relation          | ❌           | 👌      | 👌               | 👌         | 👌              |
| ActiveRecord                    | ❌           | 👌      | 👌               | 👌         | 👌              |
+---------------------------------+--------------+---------+------------------+------------+-----------------+

Calculating -------------------------------------
       Rails to_json   533.943M memsize (   248.000  retained)
                        10.850M objects (     4.000  retained)
                        50.000  strings (     0.000  retained)
             msgpack   254.390M memsize (     9.880k retained)
                         4.440M objects (    19.000  retained)
                        50.000  strings (     0.000  retained)
             Oj.dump    65.750M memsize (   272.000  retained)
                         1.140M objects (     2.000  retained)
                        40.000  strings (     0.000  retained)
    Oj::Rails.encode    65.750M memsize (     0.000  retained)
                         1.140M objects (     0.000  retained)
                        40.000  strings (     0.000  retained)

Comparison:
    Oj::Rails.encode:   65750000 allocated
             Oj.dump:   65750272 allocated - 1.00x more
             msgpack:  254389880 allocated - 3.87x more
       Rails to_json:  533942520 allocated - 8.12x more
---------------------------------------------

Warming up --------------------------------------
       Rails to_json   205.000  i/100ms
             msgpack   561.000  i/100ms
             Oj.dump     1.743k i/100ms
    Oj::Rails.encode     1.950k i/100ms
Calculating -------------------------------------
       Rails to_json      2.728k (± 8.3%) i/s -     13.735k in   5.068692s
             msgpack      6.713k (±10.1%) i/s -     33.660k in   5.061835s
             Oj.dump     19.447k (± 4.2%) i/s -     97.608k in   5.028171s
    Oj::Rails.encode     20.627k (± 7.3%) i/s -    103.350k in   5.037534s

Comparison:
    Oj::Rails.encode:    20627.1 i/s
             Oj.dump:    19446.9 i/s - same-ish: difference falls within error
             msgpack:     6713.1 i/s - 3.07x  slower
       Rails to_json:     2728.4 i/s - 7.56x  slower


SUCCESS gemfile: gemfiles/4.1.16.gemfile rvm: 2.3.3
START gemfile: gemfiles/4.1.16.gemfile rvm: 2.4.0
bundle install --deployment --path ruby-json-benchmark/vendor/bundle --quiet
bundle exec ruby compatibility_test.rb && bundle exec ruby benchmark.rb
ruby-json-benchmark/vendor/bundle/ruby/2.4.0/gems/activesupport-4.1.16/lib/active_support/core_ext/numeric/time.rb:50:in `*': ActiveSupport::Duration can't be coerced into Integer (TypeError)
	from ruby-json-benchmark/vendor/bundle/ruby/2.4.0/gems/activesupport-4.1.16/lib/active_support/core_ext/numeric/time.rb:50:in `days'
	from ruby-json-benchmark/vendor/bundle/ruby/2.4.0/gems/activesupport-4.1.16/lib/active_support/core_ext/integer/time.rb:36:in `months'
	from ruby-json-benchmark/lib/test_data_rails.rb:30:in `<top (required)>'
	from compatibility_test.rb:10:in `require'
	from compatibility_test.rb:10:in `<main>'
FAILURE gemfile: gemfiles/4.1.16.gemfile rvm: 2.4.0
START gemfile: gemfiles/4.2.8.gemfile  rvm: 2.2.6
bundle install --deployment --path ruby-json-benchmark/vendor/bundle --quiet
bundle exec ruby compatibility_test.rb && bundle exec ruby benchmark.rb

Comparing Rails to_json with other JSON implementations
+---------------------------------+--------------+---------+------------------+------------+-----------------+
| class                           | JSON to_json | Oj.dump | Oj::Rails.encode | Oj to_json | msgpack "rails" |
+---------------------------------+--------------+---------+------------------+------------+-----------------+
| Regexp                          | 👌           | 👌      | 👌               | 👌         | 👌              |
| FalseClass                      | 👌           | 👌      | 👌               | 👌         | 👌              |
| NilClass                        | 👌           | 👌      | 👌               | 👌         | 👌              |
| Object                          | ❌           | 👌      | 👌               | 👌         | 👌              |
| TrueClass                       | 👌           | 👌      | 👌               | 👌         | 👌              |
| String                          | 👌           | 👌      | 👌               | 👌         | 👌              |
| StringChinese                   | 👌           | 👌      | 👌               | 👌         | 👌              |
| StringSpecial                   | ❌           | 👌      | 👌               | 👌         | 👌              |
| StringSpecial2                  | 👌           | 👌      | 👌               | 👌         | 👌              |
| StringSpecial3                  | 👌           | 👌      | 👌               | 👌         | 👌              |
| Numeric                         | 👌           | 👌      | 👌               | 👌         | 👌              |
| Symbol                          | 👌           | 👌      | 👌               | 👌         | 👌              |
| Time                            | ❌           | 👌      | 👌               | 👌         | 👌              |
| Array                           | 👌           | 👌      | 👌               | 👌         | 👌              |
| Hash                            | 👌           | 👌      | 👌               | 👌         | 👌              |
| HashNotEmpty                    | 👌           | 👌      | 👌               | 👌         | 👌              |
| Date                            | 👌           | 👌      | 👌               | 👌         | 👌              |
| DateTime                        | ❌           | 👌      | 👌               | 👌         | 👌              |
| Enumerable                      | ❌           | 👌      | 👌               | 👌         | 👌              |
| BigDecimal                      | ❌           | 👌      | 👌               | 👌         | 👌              |
| BigDecimalInfinity              | ❌           | 👌      | 👌               | 👌         | 👌              |
| Struct                          | ❌           | 👌      | 👌               | 👌         | 👌              |
| Float                           | 👌           | 👌      | 👌               | 👌         | 👌              |
| FloatInfinity                   | 💀           | 👌      | 👌               | 👌         | ❌              |
| Range                           | 👌           | 👌      | 👌               | 👌         | 👌              |
| Complex                         | 👌           | 👌      | 👌               | 👌         | 👌              |
| Exception                       | ❌           | 👌      | 👌               | 👌         | 👌              |
| OpenStruct                      | ❌           | 👌      | 👌               | 👌         | 👌              |
| Rational                        | 👌           | 👌      | 👌               | 👌         | 👌              |
| Process::Status                 | ❌           | 👌      | 👌               | 👌         | 👌              |
| ActiveSupport::TimeWithZone     | ❌           | 👌      | 👌               | 👌         | 👌              |
| ActiveModel::Errors             | ❌           | 👌      | 👌               | 👌         | 👌              |
| ActiveSupport::Duration         | ❌           | 👌      | 👌               | 👌         | 👌              |
| ActiveSupport::Multibyte::Chars | ❌           | 👌      | 👌               | 👌         | 👌              |
| ActiveRecord::Relation          | ❌           | 👌      | 👌               | 👌         | 👌              |
| ActiveRecord                    | ❌           | 👌      | 👌               | 👌         | 👌              |
+---------------------------------+--------------+---------+------------------+------------+-----------------+

Calculating -------------------------------------
       Rails to_json   537.143M memsize (   344.000  retained)
                        10.930M objects (     5.000  retained)
                        50.000  strings (     0.000  retained)
             msgpack   259.980M memsize (   232.000  retained)
                         4.580M objects (     1.000  retained)
                        50.000  strings (     0.000  retained)
             Oj.dump    64.950M memsize (    40.000  retained)
                         1.120M objects (     1.000  retained)
                        39.000  strings (     0.000  retained)
    Oj::Rails.encode    64.950M memsize (     0.000  retained)
                         1.120M objects (     0.000  retained)
                        39.000  strings (     0.000  retained)

Comparison:
    Oj::Rails.encode:   64950000 allocated
             Oj.dump:   64950040 allocated - 1.00x more
             msgpack:  259980232 allocated - 4.00x more
       Rails to_json:  537142520 allocated - 8.27x more
---------------------------------------------

Warming up --------------------------------------
       Rails to_json   189.000  i/100ms
             msgpack   509.000  i/100ms
             Oj.dump     1.737k i/100ms
    Oj::Rails.encode     1.769k i/100ms
Calculating -------------------------------------
       Rails to_json      2.527k (±14.8%) i/s -     12.474k in   5.066571s
             msgpack      6.568k (±13.5%) i/s -     32.576k in   5.071491s
             Oj.dump     18.673k (±13.2%) i/s -     92.061k in   5.041994s
    Oj::Rails.encode     19.791k (± 9.0%) i/s -     99.064k in   5.051392s

Comparison:
    Oj::Rails.encode:    19791.2 i/s
             Oj.dump:    18673.1 i/s - same-ish: difference falls within error
             msgpack:     6568.1 i/s - 3.01x  slower
       Rails to_json:     2526.9 i/s - 7.83x  slower


SUCCESS gemfile: gemfiles/4.2.8.gemfile  rvm: 2.2.6
START gemfile: gemfiles/4.2.8.gemfile  rvm: 2.3.3
bundle install --deployment --path ruby-json-benchmark/vendor/bundle --quiet
bundle exec ruby compatibility_test.rb && bundle exec ruby benchmark.rb

Comparing Rails to_json with other JSON implementations
+---------------------------------+--------------+---------+------------------+------------+-----------------+
| class                           | JSON to_json | Oj.dump | Oj::Rails.encode | Oj to_json | msgpack "rails" |
+---------------------------------+--------------+---------+------------------+------------+-----------------+
| Regexp                          | 👌           | 👌      | 👌               | 👌         | 👌              |
| FalseClass                      | 👌           | 👌      | 👌               | 👌         | 👌              |
| NilClass                        | 👌           | 👌      | 👌               | 👌         | 👌              |
| Object                          | ❌           | 👌      | 👌               | 👌         | 👌              |
| TrueClass                       | 👌           | 👌      | 👌               | 👌         | 👌              |
| String                          | 👌           | 👌      | 👌               | 👌         | 👌              |
| StringChinese                   | 👌           | 👌      | 👌               | 👌         | 👌              |
| StringSpecial                   | ❌           | 👌      | 👌               | 👌         | 👌              |
| StringSpecial2                  | 👌           | 👌      | 👌               | 👌         | 👌              |
| StringSpecial3                  | 👌           | 👌      | 👌               | 👌         | 👌              |
| Numeric                         | 👌           | 👌      | 👌               | 👌         | 👌              |
| Symbol                          | 👌           | 👌      | 👌               | 👌         | 👌              |
| Time                            | ❌           | 👌      | 👌               | 👌         | 👌              |
| Array                           | 👌           | 👌      | 👌               | 👌         | 👌              |
| Hash                            | 👌           | 👌      | 👌               | 👌         | 👌              |
| HashNotEmpty                    | 👌           | 👌      | 👌               | 👌         | 👌              |
| Date                            | 👌           | 👌      | 👌               | 👌         | 👌              |
| DateTime                        | ❌           | 👌      | 👌               | 👌         | 👌              |
| Enumerable                      | ❌           | 👌      | 👌               | 👌         | 👌              |
| BigDecimal                      | ❌           | 👌      | 👌               | 👌         | 👌              |
| BigDecimalInfinity              | ❌           | 👌      | 👌               | 👌         | 👌              |
| Struct                          | ❌           | 👌      | 👌               | 👌         | 👌              |
| Float                           | 👌           | 👌      | 👌               | 👌         | 👌              |
| FloatInfinity                   | 💀           | 👌      | 👌               | 👌         | ❌              |
| Range                           | 👌           | 👌      | 👌               | 👌         | 👌              |
| Complex                         | 👌           | 👌      | 👌               | 👌         | 👌              |
| Exception                       | ❌           | 👌      | 👌               | 👌         | 👌              |
| OpenStruct                      | ❌           | 👌      | 👌               | 👌         | 👌              |
| Rational                        | 👌           | 👌      | 👌               | 👌         | 👌              |
| Process::Status                 | ❌           | 👌      | 👌               | 👌         | 👌              |
| ActiveSupport::TimeWithZone     | ❌           | 👌      | 👌               | 👌         | 👌              |
| ActiveModel::Errors             | ❌           | 👌      | 👌               | 👌         | 👌              |
| ActiveSupport::Duration         | ❌           | 👌      | 👌               | 👌         | 👌              |
| ActiveSupport::Multibyte::Chars | ❌           | 👌      | 👌               | 👌         | 👌              |
| ActiveRecord::Relation          | ❌           | 👌      | 👌               | 👌         | 👌              |
| ActiveRecord                    | ❌           | 👌      | 👌               | 👌         | 👌              |
+---------------------------------+--------------+---------+------------------+------------+-----------------+

Calculating -------------------------------------
       Rails to_json   533.943M memsize (   344.000  retained)
                        10.850M objects (     5.000  retained)
                        50.000  strings (     0.000  retained)
             msgpack   254.390M memsize (     9.880k retained)
                         4.440M objects (    19.000  retained)
                        50.000  strings (     0.000  retained)
             Oj.dump    65.750M memsize (   272.000  retained)
                         1.140M objects (     2.000  retained)
                        40.000  strings (     0.000  retained)
    Oj::Rails.encode    65.750M memsize (     0.000  retained)
                         1.140M objects (     0.000  retained)
                        40.000  strings (     0.000  retained)

Comparison:
    Oj::Rails.encode:   65750000 allocated
             Oj.dump:   65750272 allocated - 1.00x more
             msgpack:  254389880 allocated - 3.87x more
       Rails to_json:  533942520 allocated - 8.12x more
---------------------------------------------

Warming up --------------------------------------
       Rails to_json   152.000  i/100ms
             msgpack   519.000  i/100ms
             Oj.dump     1.699k i/100ms
    Oj::Rails.encode     1.990k i/100ms
Calculating -------------------------------------
       Rails to_json      2.547k (±15.1%) i/s -     12.464k in   5.013954s
             msgpack      6.142k (±19.2%) i/s -     29.583k in   5.013085s
             Oj.dump     18.226k (±12.7%) i/s -     90.047k in   5.028200s
    Oj::Rails.encode     17.945k (±12.1%) i/s -     89.550k in   5.074290s

Comparison:
             Oj.dump:    18226.0 i/s
    Oj::Rails.encode:    17945.2 i/s - same-ish: difference falls within error
             msgpack:     6142.2 i/s - 2.97x  slower
       Rails to_json:     2546.7 i/s - 7.16x  slower


SUCCESS gemfile: gemfiles/4.2.8.gemfile  rvm: 2.3.3
START gemfile: gemfiles/4.2.8.gemfile  rvm: 2.4.0
bundle install --deployment --path ruby-json-benchmark/vendor/bundle --quiet
bundle exec ruby compatibility_test.rb && bundle exec ruby benchmark.rb

Comparing Rails to_json with other JSON implementations
+---------------------------------+--------------+---------+------------------+------------+-----------------+
| class                           | JSON to_json | Oj.dump | Oj::Rails.encode | Oj to_json | msgpack "rails" |
+---------------------------------+--------------+---------+------------------+------------+-----------------+
| Regexp                          | 👌           | 👌      | 👌               | 👌         | 👌              |
| FalseClass                      | 👌           | 👌      | 👌               | 👌         | 👌              |
| NilClass                        | 👌           | 👌      | 👌               | 👌         | 👌              |
| Object                          | ❌           | 👌      | 👌               | 👌         | 👌              |
| TrueClass                       | 👌           | 👌      | 👌               | 👌         | 👌              |
| String                          | 👌           | 👌      | 👌               | 👌         | 👌              |
| StringChinese                   | 👌           | 👌      | 👌               | 👌         | 👌              |
| StringSpecial                   | ❌           | 👌      | 👌               | 👌         | 👌              |
| StringSpecial2                  | 👌           | 👌      | 👌               | 👌         | 👌              |
| StringSpecial3                  | 👌           | 👌      | 👌               | 👌         | 👌              |
| Numeric                         | 👌           | 👌      | 👌               | 👌         | 👌              |
| Symbol                          | 👌           | 👌      | 👌               | 👌         | 👌              |
| Time                            | ❌           | 👌      | 👌               | 👌         | 👌              |
| Array                           | 👌           | 👌      | 👌               | 👌         | 👌              |
| Hash                            | 👌           | 👌      | 👌               | 👌         | 👌              |
| HashNotEmpty                    | 👌           | 👌      | 👌               | 👌         | 👌              |
| Date                            | 👌           | 👌      | 👌               | 👌         | 👌              |
| DateTime                        | ❌           | 👌      | 👌               | 👌         | 👌              |
| Enumerable                      | ❌           | 👌      | 👌               | 👌         | 👌              |
| BigDecimal                      | ❌           | 👌      | 👌               | 👌         | 👌              |
| BigDecimalInfinity              | ❌           | 👌      | 👌               | 👌         | 👌              |
| Struct                          | ❌           | 👌      | 👌               | 👌         | 👌              |
| Float                           | 👌           | 👌      | 👌               | 👌         | 👌              |
| FloatInfinity                   | 💀           | 👌      | 👌               | 👌         | ❌              |
| Range                           | 👌           | 👌      | 👌               | 👌         | 👌              |
| Complex                         | 👌           | 👌      | 👌               | 👌         | 👌              |
| Exception                       | ❌           | 👌      | 👌               | 👌         | 👌              |
| OpenStruct                      | ❌           | 👌      | 👌               | 👌         | 👌              |
| Rational                        | 👌           | 👌      | 👌               | 👌         | 👌              |
| Process::Status                 | ❌           | 👌      | 👌               | 👌         | 👌              |
| ActiveSupport::TimeWithZone     | ❌           | 👌      | 👌               | 👌         | 👌              |
| ActiveModel::Errors             | ❌           | 👌      | 👌               | 👌         | 👌              |
| ActiveSupport::Duration         | ❌           | 👌      | 👌               | 👌         | 👌              |
| ActiveSupport::Multibyte::Chars | ❌           | 👌      | 👌               | 👌         | 👌              |
| ActiveRecord::Relation          | ❌           | 👌      | 👌               | 👌         | 👌              |
| ActiveRecord                    | ❌           | 👌      | 👌               | 👌         | 👌              |
+---------------------------------+--------------+---------+------------------+------------+-----------------+

Calculating -------------------------------------
       Rails to_json   522.522M memsize (   536.000  retained)
                        10.750M objects (     6.000  retained)
                        50.000  strings (     0.000  retained)
             msgpack   238.258M memsize (     8.400k retained)
                         4.340M objects (    19.000  retained)
                        50.000  strings (     0.000  retained)
             Oj.dump    65.480M memsize (   232.000  retained)
                         1.130M objects (     2.000  retained)
                        40.000  strings (     0.000  retained)
    Oj::Rails.encode    65.480M memsize (     0.000  retained)
                         1.130M objects (     0.000  retained)
                        40.000  strings (     0.000  retained)

Comparison:
    Oj::Rails.encode:   65480000 allocated
             Oj.dump:   65480232 allocated - 1.00x more
             msgpack:  238258400 allocated - 3.64x more
       Rails to_json:  522522272 allocated - 7.98x more
---------------------------------------------

Warming up --------------------------------------
       Rails to_json   292.000  i/100ms
             msgpack   693.000  i/100ms
             Oj.dump     1.697k i/100ms
    Oj::Rails.encode     1.676k i/100ms
Calculating -------------------------------------
       Rails to_json      2.828k (± 4.9%) i/s -     14.308k in   5.071627s
             msgpack      7.274k (± 3.9%) i/s -     36.729k in   5.056762s
             Oj.dump     17.822k (± 9.7%) i/s -     88.244k in   5.000179s
    Oj::Rails.encode     18.517k (± 9.1%) i/s -     92.180k in   5.021109s

Comparison:
    Oj::Rails.encode:    18517.4 i/s
             Oj.dump:    17822.2 i/s - same-ish: difference falls within error
             msgpack:     7274.4 i/s - 2.55x  slower
       Rails to_json:     2828.4 i/s - 6.55x  slower


SUCCESS gemfile: gemfiles/4.2.8.gemfile  rvm: 2.4.0
START gemfile: gemfiles/5.0.2.gemfile  rvm: 2.2.6
bundle install --deployment --path ruby-json-benchmark/vendor/bundle --quiet
bundle exec ruby compatibility_test.rb && bundle exec ruby benchmark.rb

Comparing Rails to_json with other JSON implementations
+---------------------------------+--------------+---------+------------------+------------+-----------------+
| class                           | JSON to_json | Oj.dump | Oj::Rails.encode | Oj to_json | msgpack "rails" |
+---------------------------------+--------------+---------+------------------+------------+-----------------+
| Regexp                          | 👌           | 👌      | 👌               | 👌         | 👌              |
| FalseClass                      | 👌           | 👌      | 👌               | 👌         | 👌              |
| NilClass                        | 👌           | 👌      | 👌               | 👌         | 👌              |
| Object                          | ❌           | 👌      | 👌               | 👌         | 👌              |
| TrueClass                       | 👌           | 👌      | 👌               | 👌         | 👌              |
| String                          | 👌           | 👌      | 👌               | 👌         | 👌              |
| StringChinese                   | 👌           | 👌      | 👌               | 👌         | 👌              |
| StringSpecial                   | ❌           | 👌      | 👌               | 👌         | 👌              |
| StringSpecial2                  | 👌           | 👌      | 👌               | 👌         | 👌              |
| StringSpecial3                  | 👌           | 👌      | 👌               | 👌         | 👌              |
| Numeric                         | 👌           | 👌      | 👌               | 👌         | 👌              |
| Symbol                          | 👌           | 👌      | 👌               | 👌         | 👌              |
| Time                            | ❌           | 👌      | 👌               | 👌         | 👌              |
| Array                           | 👌           | 👌      | 👌               | 👌         | 👌              |
| Hash                            | 👌           | 👌      | 👌               | 👌         | 👌              |
| HashNotEmpty                    | 👌           | 👌      | 👌               | 👌         | 👌              |
| Date                            | 👌           | 👌      | 👌               | 👌         | 👌              |
| DateTime                        | ❌           | 👌      | 👌               | 👌         | 👌              |
| Enumerable                      | ❌           | 👌      | 👌               | 👌         | 👌              |
| BigDecimal                      | ❌           | 👌      | 👌               | 👌         | 👌              |
| BigDecimalInfinity              | ❌           | 👌      | 👌               | 👌         | 👌              |
| Struct                          | ❌           | 👌      | 👌               | 👌         | 👌              |
| Float                           | 👌           | 👌      | 👌               | 👌         | 👌              |
| FloatInfinity                   | 💀           | 👌      | 👌               | 👌         | ❌              |
| Range                           | 👌           | 👌      | 👌               | 👌         | 👌              |
| Complex                         | 👌           | 👌      | 👌               | 👌         | 👌              |
| Exception                       | 👌           | 👌      | 👌               | 👌         | 👌              |
| OpenStruct                      | ❌           | 👌      | 👌               | 👌         | 👌              |
| Rational                        | 👌           | 👌      | 👌               | 👌         | 👌              |
| Process::Status                 | ❌           | 👌      | 👌               | 👌         | 👌              |
| ActiveSupport::TimeWithZone     | ❌           | 👌      | 👌               | 👌         | 👌              |
| ActiveModel::Errors             | ❌           | 👌      | 👌               | 👌         | 👌              |
| ActiveSupport::Duration         | ❌           | 👌      | 👌               | 👌         | 👌              |
| ActiveSupport::Multibyte::Chars | ❌           | 👌      | 👌               | 👌         | 👌              |
| ActiveRecord::Relation          | ❌           | 👌      | 👌               | 👌         | 👌              |
| ActiveRecord                    | ❌           | 👌      | 👌               | 👌         | 👌              |
+---------------------------------+--------------+---------+------------------+------------+-----------------+

Calculating -------------------------------------
       Rails to_json   532.433M memsize (   464.000  retained)
                        10.810M objects (     7.000  retained)
                        50.000  strings (     1.000  retained)
             msgpack   254.080M memsize (   232.000  retained)
                         4.430M objects (     1.000  retained)
                        50.000  strings (     0.000  retained)
             Oj.dump    63.750M memsize (    40.000  retained)
                         1.090M objects (     1.000  retained)
                        39.000  strings (     0.000  retained)
    Oj::Rails.encode    63.750M memsize (     0.000  retained)
                         1.090M objects (     0.000  retained)
                        39.000  strings (     0.000  retained)

Comparison:
    Oj::Rails.encode:   63750000 allocated
             Oj.dump:   63750040 allocated - 1.00x more
             msgpack:  254080232 allocated - 3.99x more
       Rails to_json:  532432848 allocated - 8.35x more
---------------------------------------------

Warming up --------------------------------------
       Rails to_json   236.000  i/100ms
             msgpack   639.000  i/100ms
             Oj.dump     1.840k i/100ms
    Oj::Rails.encode     1.878k i/100ms
Calculating -------------------------------------
       Rails to_json      2.661k (±15.6%) i/s -     13.216k in   5.114534s
             msgpack      7.149k (±15.4%) i/s -     35.145k in   5.052496s
             Oj.dump     18.711k (± 7.5%) i/s -     93.840k in   5.045124s
    Oj::Rails.encode     18.407k (±10.7%) i/s -     92.022k in   5.066186s

Comparison:
             Oj.dump:    18710.8 i/s
    Oj::Rails.encode:    18407.3 i/s - same-ish: difference falls within error
             msgpack:     7148.9 i/s - 2.62x  slower
       Rails to_json:     2661.3 i/s - 7.03x  slower


SUCCESS gemfile: gemfiles/5.0.2.gemfile  rvm: 2.2.6
START gemfile: gemfiles/5.0.2.gemfile  rvm: 2.3.3
bundle install --deployment --path ruby-json-benchmark/vendor/bundle --quiet
bundle exec ruby compatibility_test.rb && bundle exec ruby benchmark.rb

Comparing Rails to_json with other JSON implementations
+---------------------------------+--------------+---------+------------------+------------+-----------------+
| class                           | JSON to_json | Oj.dump | Oj::Rails.encode | Oj to_json | msgpack "rails" |
+---------------------------------+--------------+---------+------------------+------------+-----------------+
| Regexp                          | 👌           | 👌      | 👌               | 👌         | 👌              |
| FalseClass                      | 👌           | 👌      | 👌               | 👌         | 👌              |
| NilClass                        | 👌           | 👌      | 👌               | 👌         | 👌              |
| Object                          | ❌           | 👌      | 👌               | 👌         | 👌              |
| TrueClass                       | 👌           | 👌      | 👌               | 👌         | 👌              |
| String                          | 👌           | 👌      | 👌               | 👌         | 👌              |
| StringChinese                   | 👌           | 👌      | 👌               | 👌         | 👌              |
| StringSpecial                   | ❌           | 👌      | 👌               | 👌         | 👌              |
| StringSpecial2                  | 👌           | 👌      | 👌               | 👌         | 👌              |
| StringSpecial3                  | 👌           | 👌      | 👌               | 👌         | 👌              |
| Numeric                         | 👌           | 👌      | 👌               | 👌         | 👌              |
| Symbol                          | 👌           | 👌      | 👌               | 👌         | 👌              |
| Time                            | ❌           | 👌      | 👌               | 👌         | 👌              |
| Array                           | 👌           | 👌      | 👌               | 👌         | 👌              |
| Hash                            | 👌           | 👌      | 👌               | 👌         | 👌              |
| HashNotEmpty                    | 👌           | 👌      | 👌               | 👌         | 👌              |
| Date                            | 👌           | 👌      | 👌               | 👌         | 👌              |
| DateTime                        | ❌           | 👌      | 👌               | 👌         | 👌              |
| Enumerable                      | ❌           | 👌      | 👌               | 👌         | 👌              |
| BigDecimal                      | ❌           | 👌      | 👌               | 👌         | 👌              |
| BigDecimalInfinity              | ❌           | 👌      | 👌               | 👌         | 👌              |
| Struct                          | ❌           | 👌      | 👌               | 👌         | 👌              |
| Float                           | 👌           | 👌      | 👌               | 👌         | 👌              |
| FloatInfinity                   | 💀           | 👌      | 👌               | 👌         | ❌              |
| Range                           | 👌           | 👌      | 👌               | 👌         | 👌              |
| Complex                         | 👌           | 👌      | 👌               | 👌         | 👌              |
| Exception                       | 👌           | 👌      | 👌               | 👌         | 👌              |
| OpenStruct                      | ❌           | 👌      | 👌               | 👌         | 👌              |
| Rational                        | 👌           | 👌      | 👌               | 👌         | 👌              |
| Process::Status                 | ❌           | 👌      | 👌               | 👌         | 👌              |
| ActiveSupport::TimeWithZone     | ❌           | 👌      | 👌               | 👌         | 👌              |
| ActiveModel::Errors             | ❌           | 👌      | 👌               | 👌         | 👌              |
| ActiveSupport::Duration         | ❌           | 👌      | 👌               | 👌         | 👌              |
| ActiveSupport::Multibyte::Chars | ❌           | 👌      | 👌               | 👌         | 👌              |
| ActiveRecord::Relation          | ❌           | 👌      | 👌               | 👌         | 👌              |
| ActiveRecord                    | ❌           | 👌      | 👌               | 👌         | 👌              |
+---------------------------------+--------------+---------+------------------+------------+-----------------+

Calculating -------------------------------------
       Rails to_json   529.233M memsize (   464.000  retained)
                        10.730M objects (     7.000  retained)
                        50.000  strings (     1.000  retained)
             msgpack   248.490M memsize (     9.880k retained)
                         4.290M objects (    19.000  retained)
                        50.000  strings (     0.000  retained)
             Oj.dump    64.550M memsize (   272.000  retained)
                         1.110M objects (     2.000  retained)
                        40.000  strings (     0.000  retained)
    Oj::Rails.encode    64.550M memsize (     0.000  retained)
                         1.110M objects (     0.000  retained)
                        40.000  strings (     0.000  retained)

Comparison:
    Oj::Rails.encode:   64550000 allocated
             Oj.dump:   64550272 allocated - 1.00x more
             msgpack:  248489880 allocated - 3.85x more
       Rails to_json:  529232848 allocated - 8.20x more
---------------------------------------------

Warming up --------------------------------------
       Rails to_json   150.000  i/100ms
             msgpack   570.000  i/100ms
             Oj.dump     1.559k i/100ms
    Oj::Rails.encode     1.808k i/100ms
Calculating -------------------------------------
       Rails to_json      2.269k (±14.0%) i/s -     11.250k in   5.059478s
             msgpack      5.968k (±20.1%) i/s -     29.070k in   5.079662s
             Oj.dump     17.267k (±12.6%) i/s -     85.745k in   5.050222s
    Oj::Rails.encode     18.749k (± 8.2%) i/s -     94.016k in   5.048424s

Comparison:
    Oj::Rails.encode:    18748.8 i/s
             Oj.dump:    17267.2 i/s - same-ish: difference falls within error
             msgpack:     5968.3 i/s - 3.14x  slower
       Rails to_json:     2269.0 i/s - 8.26x  slower


SUCCESS gemfile: gemfiles/5.0.2.gemfile  rvm: 2.3.3
START gemfile: gemfiles/5.0.2.gemfile  rvm: 2.4.0
bundle install --deployment --path ruby-json-benchmark/vendor/bundle --quiet
bundle exec ruby compatibility_test.rb && bundle exec ruby benchmark.rb

Comparing Rails to_json with other JSON implementations
+---------------------------------+--------------+---------+------------------+------------+-----------------+
| class                           | JSON to_json | Oj.dump | Oj::Rails.encode | Oj to_json | msgpack "rails" |
+---------------------------------+--------------+---------+------------------+------------+-----------------+
| Regexp                          | 👌           | 👌      | 👌               | 👌         | 👌              |
| FalseClass                      | 👌           | 👌      | 👌               | 👌         | 👌              |
| NilClass                        | 👌           | 👌      | 👌               | 👌         | 👌              |
| Object                          | ❌           | 👌      | 👌               | 👌         | 👌              |
| TrueClass                       | 👌           | 👌      | 👌               | 👌         | 👌              |
| String                          | 👌           | 👌      | 👌               | 👌         | 👌              |
| StringChinese                   | 👌           | 👌      | 👌               | 👌         | 👌              |
| StringSpecial                   | ❌           | 👌      | 👌               | 👌         | 👌              |
| StringSpecial2                  | 👌           | 👌      | 👌               | 👌         | 👌              |
| StringSpecial3                  | 👌           | 👌      | 👌               | 👌         | 👌              |
| Numeric                         | 👌           | 👌      | 👌               | 👌         | 👌              |
| Symbol                          | 👌           | 👌      | 👌               | 👌         | 👌              |
| Time                            | ❌           | 👌      | 👌               | 👌         | 👌              |
| Array                           | 👌           | 👌      | 👌               | 👌         | 👌              |
| Hash                            | 👌           | 👌      | 👌               | 👌         | 👌              |
| HashNotEmpty                    | 👌           | 👌      | 👌               | 👌         | 👌              |
| Date                            | 👌           | 👌      | 👌               | 👌         | 👌              |
| DateTime                        | ❌           | 👌      | 👌               | 👌         | 👌              |
| Enumerable                      | ❌           | 👌      | 👌               | 👌         | 👌              |
| BigDecimal                      | ❌           | 👌      | 👌               | 👌         | 👌              |
| BigDecimalInfinity              | ❌           | 👌      | 👌               | 👌         | 👌              |
| Struct                          | ❌           | 👌      | 👌               | 👌         | 👌              |
| Float                           | 👌           | 👌      | 👌               | 👌         | 👌              |
| FloatInfinity                   | 💀           | 👌      | 👌               | 👌         | ❌              |
| Range                           | 👌           | 👌      | 👌               | 👌         | 👌              |
| Complex                         | 👌           | 👌      | 👌               | 👌         | 👌              |
| Exception                       | 👌           | 👌      | 👌               | 👌         | 👌              |
| OpenStruct                      | ❌           | 👌      | 👌               | 👌         | 👌              |
| Rational                        | 👌           | 👌      | 👌               | 👌         | 👌              |
| Process::Status                 | ❌           | 👌      | 👌               | 👌         | 👌              |
| ActiveSupport::TimeWithZone     | ❌           | 👌      | 👌               | 👌         | 👌              |
| ActiveModel::Errors             | ❌           | 👌      | 👌               | 👌         | 👌              |
| ActiveSupport::Duration         | ❌           | 👌      | 👌               | 👌         | 👌              |
| ActiveSupport::Multibyte::Chars | ❌           | 👌      | 👌               | 👌         | 👌              |
| ActiveRecord::Relation          | ❌           | 👌      | 👌               | 👌         | 👌              |
| ActiveRecord                    | ❌           | 👌      | 👌               | 👌         | 👌              |
+---------------------------------+--------------+---------+------------------+------------+-----------------+

Calculating -------------------------------------
       Rails to_json   518.613M memsize (   656.000  retained)
                        10.650M objects (     8.000  retained)
                        50.000  strings (     1.000  retained)
             msgpack   233.158M memsize (     8.400k retained)
                         4.210M objects (    19.000  retained)
                        50.000  strings (     0.000  retained)
             Oj.dump    64.280M memsize (   232.000  retained)
                         1.100M objects (     2.000  retained)
                        40.000  strings (     0.000  retained)
    Oj::Rails.encode    64.280M memsize (     0.000  retained)
                         1.100M objects (     0.000  retained)
                        40.000  strings (     0.000  retained)

Comparison:
    Oj::Rails.encode:   64280000 allocated
             Oj.dump:   64280232 allocated - 1.00x more
             msgpack:  233158400 allocated - 3.63x more
       Rails to_json:  518612520 allocated - 8.07x more
---------------------------------------------

Warming up --------------------------------------
       Rails to_json   227.000  i/100ms
             msgpack   558.000  i/100ms
             Oj.dump     1.514k i/100ms
    Oj::Rails.encode     1.700k i/100ms
Calculating -------------------------------------
       Rails to_json      2.329k (± 9.1%) i/s -     11.577k in   5.013273s
             msgpack      6.013k (±14.8%) i/s -     29.574k in   5.046335s
             Oj.dump     17.004k (±14.7%) i/s -     83.270k in   5.048882s
    Oj::Rails.encode     16.936k (±14.8%) i/s -     83.300k in   5.044410s

Comparison:
             Oj.dump:    17004.5 i/s
    Oj::Rails.encode:    16935.6 i/s - same-ish: difference falls within error
             msgpack:     6012.8 i/s - 2.83x  slower
       Rails to_json:     2328.8 i/s - 7.30x  slower


SUCCESS gemfile: gemfiles/5.0.2.gemfile  rvm: 2.4.0
rm -rf .bundle

Results:
SUCCESS gemfile: gemfiles/4.1.16.gemfile rvm: 2.2.6
SUCCESS gemfile: gemfiles/4.1.16.gemfile rvm: 2.3.3
FAILURE gemfile: gemfiles/4.1.16.gemfile rvm: 2.4.0
SUCCESS gemfile: gemfiles/4.2.8.gemfile  rvm: 2.2.6
SUCCESS gemfile: gemfiles/4.2.8.gemfile  rvm: 2.3.3
SUCCESS gemfile: gemfiles/4.2.8.gemfile  rvm: 2.4.0
SUCCESS gemfile: gemfiles/5.0.2.gemfile  rvm: 2.2.6
SUCCESS gemfile: gemfiles/5.0.2.gemfile  rvm: 2.3.3
SUCCESS gemfile: gemfiles/5.0.2.gemfile  rvm: 2.4.0

Failed:
BUNDLE_GEMFILE=gemfiles/4.1.16.gemfile RBENV_VERSION=2.4.0 bundle exec ruby compatibility_test.rb && bundle exec ruby benchmark.rb
